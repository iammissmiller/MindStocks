<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Role of SEBI Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#f6f8fa; --navy:#0D1B2A; --accent:#E63946;
  --card:#fff; --muted:#556677; --soft:#f1faf8;
  --radius:12px; --shadow:0 10px 30px rgba(13,27,42,0.08);
  --transition:220ms cubic-bezier(.2,.9,.3,1);
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Inter,system-ui,sans-serif;
  background:var(--bg);color:var(--navy);
  display:flex;flex-direction:column;min-height:100vh;
}
/* 🌙 Refined Dark Mode for Quiz Pages */
.dark-mode {
  background-color: #0b0f19;
  color: #e2e2ec;
}

/* Header */
.dark-mode .header {
  background: linear-gradient(90deg, #111827, #1e293b);
  color: #a5b4fc;
  box-shadow: 0 2px 10px rgba(79, 70, 229, 0.3);
}
.dark-mode .header h1,
.dark-mode .header p {
  color: #c7d2fe;
}

/* Start & Quiz Cards */
.dark-mode .start-screen,
.dark-mode .quiz-card {
  background-color: #1c1c2a;
  color: #d1d5db;
  box-shadow: 0 4px 14px rgba(0,0,0,0.8);
}
.dark-mode .start-screen h2,
.dark-mode .quiz-card h3 {
  color: #a5b4fc;
}
.dark-mode .start-screen p {
  color: #9ca3af;
}

/* Buttons */
.dark-mode button,
.dark-mode .start-btn,
.dark-mode .btn-link {
  background: #4f46e5;
  color: white;
}
.dark-mode button:hover,
.dark-mode .start-btn:hover,
.dark-mode .btn-link:hover {
  background: #4338ca;
}
.dark-mode button:disabled {
  background: #374151;
  color: #6b7280;
}

/* Options */
.dark-mode .options label {
  background: #262639;
  color: #d1d5db;
}
.dark-mode .options label:hover {
  background: #312e81;
}

/* Result */
.dark-mode .result {
  background: #1c1c2a;
  color: #e2e2ec;
  box-shadow: 0 6px 20px rgba(79, 70, 229, 0.3);
}
.dark-mode .score-counter {
  color: #a5b4fc;
}
.dark-mode .message {
  color: #9ca3af;
}

/* Review Section */
.dark-mode .review-container {
  background: #1c1c2a;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6);
}
.dark-mode .review-item {
  background: #262639;
  border-left-color: #4f46e5; /* default indigo border */
}
.dark-mode .review-item.correct {
  border-left-color: #16a34a; /* green */
}
.dark-mode .review-item.wrong {
  border-left-color: #dc2626; /* red */
}
.dark-mode .explanation {
  color: #9ca3af;
}

/* Progress Circle */
.dark-mode .progress-bg {
  stroke: #2d2d44;
}
.dark-mode .progress-text {
  color: #e2e2ec;
}

/* Footer */
.dark-mode footer {
  background-color: #0f172a;
  color: #9ca3af;
  border-top: 1px solid #2d2d44;
}
.dark-mode footer a {
  color: #818cf8;
}
.dark-mode footer a:hover {
  color: #c7d2fe;
}

/* Header */
.header{
  background:linear-gradient(90deg,var(--navy),#123544);
  color:#fff;padding:28px 18px;
  width:100%;display:flex;align-items:center;gap:14px;
}
.header img{width:50px;height:50px;border-radius:50%;background:white;padding:5px}
.header h1{font-size:1.6rem;font-weight:700}
.header p{margin-top:4px;color:rgba(255,255,255,0.9);font-size:.95rem}

/* Container */
.container{width:100%;flex:1;display:flex;justify-content:center;align-items: center;padding:20px;}
.inner{width:100%;max-width:900px;}

/* Start Screen & Quiz Card */
.start-screen,.quiz-card{
  background:var(--card);border-radius:var(--radius);
  box-shadow:var(--shadow);padding:30px;text-align:center;
}
.start-screen h2{font-size:1.4rem;margin-bottom:10px}
.start-screen p{font-size:1rem;color:var(--muted);margin-bottom:20px}
.start-btn{
  background:var(--navy);color:white;padding:12px 24px;
  border:none;border-radius:999px;font-weight:600;font-size:1rem;
  cursor:pointer;transition:background var(--transition);
}
.start-btn:hover{background:var(--accent)}

/* Quiz */
.quiz-card h3{font-size:1.1rem;font-weight:600;margin-bottom:12px;text-align:left}
.options{margin-top:10px;text-align:left}
.options label{
  display:block;background:var(--soft);margin-bottom:8px;
  padding:10px;border-radius:8px;cursor:pointer;
  transition:background var(--transition);
}
.options input{margin-right:8px}
.options label:hover{background:#e8f6f3}

/* Buttons */
.quiz-buttons{display:flex;gap:10px;margin-top:15px;flex-wrap:wrap;}
button{
  background:var(--navy);color:white;padding:10px 18px;
  border:none;border-radius:999px;font-weight:600;
  cursor:pointer;transition:background var(--transition);
}
button:hover{background:var(--accent)}
button:disabled{background:#ccc;cursor:not-allowed}

/* Result */
.result{
  margin-top:30px;padding:30px;border-radius:var(--radius);
  background:#fff;text-align:center;
  box-shadow:0 8px 20px rgba(0,0,0,0.15);
}
.score-counter{font-size:2rem;font-weight:700;margin-bottom:10px}
.message{font-size:1.2rem;margin-bottom:20px}

/* Progress Circle */
.progress-container{width:160px;height:160px;margin:20px auto;position:relative;}
.progress-container svg{transform:rotate(-90deg)}
.progress-container circle{
  fill:none;stroke-width:14;stroke-linecap:round;
}
.progress-bg{stroke:#eee;}
.progress-bar{stroke:url(#scoreGradient);stroke-dasharray:440;stroke-dashoffset:440;transition:stroke-dashoffset 1s ease;}
.progress-text{
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  font-size:1.2rem;font-weight:700;
}

/* Review Section */
.review-container {
  margin-top: 25px;
  padding: 20px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.08);
}
.review-container h3 {
  margin-bottom: 16px;
  font-size: 1.2rem;
  font-weight: 700;
}
.review-item {
  padding: 12px;
  border-radius: 8px;
  margin-bottom: 12px;
  background: #f9fafb;
  border-left: 6px solid #d1d5db;
}
.review-item.correct { border-left-color: #16a34a; } /* green */
.review-item.wrong { border-left-color: #dc2626; }   /* red */
.review-item h4 { font-size: 1rem; margin-bottom: 6px; }
.review-item p { margin: 3px 0; font-size: 0.95rem; }
.explanation { font-style: italic; color: #374151; }

/* Footer */
footer{background:#111827;color:#fff;text-align:center;padding:16px;font-size:.9rem;width:100%;}
footer a{color:#93c5fd}

.btn-link {
  display:inline-block;
  text-decoration:none;
  background:var(--navy);
  color:#fff;
  padding:12px 24px;
  border-radius:999px;
  font-weight:600;
  font-size:1rem;
  transition:background var(--transition);
  text-align:center;
}
.btn-link:hover { background:var(--accent); }
@media(max-width:600px){
  .btn-link { display:block;width:100%;margin-bottom:10px; }
}

/* Responsive */
@media(max-width:1023px){.header{flex-direction:column;text-align:center}.header img{margin-bottom:10px}.quiz-buttons{justify-content:center}}
@media(max-width:600px){.header h1{font-size:1.3rem}.header p{font-size:.85rem}.start-screen,.quiz-card{padding:20px}.quiz-card h3{font-size:1rem}button,.start-btn{width:100%;padding:12px}}
</style>
</head>
<body>

<div class="header">
  <img src="https://cdn-icons-png.flaticon.com/512/2331/2331947.png" alt="Quiz">
  <div>
    <h1>Role of SEBI Quiz</h1>
    <p>Test your knowledge about the functions and responsibilities of SEBI.</p>
  </div>
</div>

<div class="container" id="start-screen">
  <div class="inner">
    <div class="start-screen">
      <h2>Welcome to the Role of SEBI Quiz</h2>
      <p>Click the button below to begin your quiz and test your knowledge.</p>
      <button class="start-btn" onclick="startQuiz()">Start Quiz</button>
    </div>
  </div>
</div>

<div class="container" id="quiz-container" style="display:none;">
  <div class="inner" id="quiz-inner"></div>
</div>

<div class="container" id="quiz-controls" style="display:none;">
  <div class="inner">
    <div class="quiz-buttons">
      <button id="prev-btn" onclick="prevQuestion()">Previous</button>
      <button id="next-btn" onclick="nextQuestion()">Next</button>
    </div>
    <div id="result" style="display:none;"></div>
  </div>
</div>

<footer>
  © 2025 MindStocks | Built for SEBI Hackathon |
  <a href="https://mail.google.com/mail/?view=cm&fs=1&to=sebi@sebi.gov.in" target="_blank">Contact Us</a>
</footer>

<script>

  const DEFAULT_PROGRESS = {
  lessons: 0,
  totalLessons: 8,   // adjust to real number
  quizzes: 0,
  totalQuizzes: 8,   // since you have 8 quizzes
  trading: 0,
  tradingHistory: []
};

function getProgress() {
  return JSON.parse(localStorage.getItem("mindstocksProgress")) || { ...DEFAULT_PROGRESS };
}

function saveProgress(p) {
  localStorage.setItem("mindstocksProgress", JSON.stringify(p));
}

const MindStocks = {
  completeLesson() {
    const p = getProgress();
    if (p.lessons < p.totalLessons) p.lessons++;
    saveProgress(p);
  },
  completeQuiz() {
    const p = getProgress();
    if (p.quizzes < p.totalQuizzes) p.quizzes++;
    saveProgress(p);
  },
  recordTrade() {
    const p = getProgress();
    p.trading++;
    p.tradingHistory.push(Date.now());
    saveProgress(p);
  }
};

const quizData = [
  {question:"What is the primary role of SEBI in the Indian securities market?",options:["To set company tax rates","To regulate and protect the securities market","To manage foreign trade policies","To provide loans to investors"],answer:1,explanation:"SEBI’s main role is to regulate and protect the securities market to ensure fair practices."},
  {question:"Which of the following is NOT a responsibility of SEBI?",options:["Preventing insider trading","Monitoring trading activities","Printing currency notes","Protecting investors from fraud"],answer:2,explanation:"Printing currency notes is the role of RBI, not SEBI."},
  {question:"How does SEBI protect investors?",options:["By ensuring companies share accurate financial reports","By promoting unfair advantages in the market","By restricting all foreign investments","By fixing the prices of shares"],answer:0,explanation:"SEBI ensures companies disclose accurate financial reports to protect investors."},
  {question:"Which of the following comes under SEBI’s market regulation role?",options:["Providing subsidies to companies","Introducing new investment products","Monitoring compliance with market rules","Printing stock certificates"],answer:2,explanation:"SEBI monitors compliance with market rules to regulate the securities market."},
  {question:"In its dispute resolution role, SEBI aims to:",options:["Delay market settlements to avoid risks","Ensure quick and fair complaint resolutions","Increase the complexity of investor grievances","Promote market monopolies"],answer:1,explanation:"SEBI resolves disputes quickly and fairly to maintain trust in the market."},
  {question:"SEBI’s market development role includes:",options:["Conducting Investor Awareness Programs","Preventing international trade","Printing financial newspapers","Collecting income tax from traders"],answer:0,explanation:"SEBI conducts Investor Awareness Programs to educate and develop market knowledge."}
];

let quiz = [];
let currentQuestion = 0, score = 0, answers = [];

function shuffleArray(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}
function buildShuffledQuiz(){
  const shuffledQuestions = shuffleArray(quizData.map(q=>({...q})));
  return shuffledQuestions.map(q=>{
    const correctText = q.options[q.answer];
    const shuffledOptions = shuffleArray([...q.options]);
    const newAnswerIndex = shuffledOptions.indexOf(correctText);
    return {...q,options:shuffledOptions,answer:newAnswerIndex};
  });
}

function startQuiz(){
  quiz = buildShuffledQuiz();
  answers = new Array(quiz.length).fill(null);
  currentQuestion=0; score=0;
  document.getElementById("start-screen").style.display="none";
  document.getElementById("quiz-container").style.display="flex";
  document.getElementById("quiz-controls").style.display="flex";
  loadQuestion();
}

function loadQuestion(){
  const quizInner=document.getElementById("quiz-inner");
  quizInner.innerHTML="";
  const q=quiz[currentQuestion];
  const card=document.createElement("div");
  card.className="quiz-card";
  card.innerHTML=`
    <h3>Q${currentQuestion+1} of ${quiz.length}. ${q.question}</h3>
    <div class="options">
      ${q.options.map((opt,i)=>`
        <label data-option="${i}">
          <input type="radio" name="q${currentQuestion}" value="${i}" ${answers[currentQuestion]===i?'checked':''}> ${opt}
        </label>`).join("")}
    </div>`;
  quizInner.appendChild(card);
  document.getElementById("prev-btn").disabled=currentQuestion===0;
  document.getElementById("next-btn").textContent=currentQuestion===quiz.length-1?"Submit Quiz":"Next";
}

function nextQuestion(){
  const selected=document.querySelector(`input[name="q${currentQuestion}"]:checked`);
  if(!selected){alert("Please select an answer before continuing.");return;}
  const selectedValue=parseInt(selected.value,10);
  answers[currentQuestion]=selectedValue;
  if(currentQuestion<quiz.length-1){currentQuestion++;loadQuestion();}
  else{showResult();}
}

function prevQuestion(){
  if(currentQuestion>0){currentQuestion--;loadQuestion();}
}

function animateCounter(el,target){
  let count=0;
  const step=Math.ceil(target/50);
  const interval=setInterval(()=>{
    count+=step;
    if(count>=target){count=target;clearInterval(interval);}
    el.textContent=count;
  },30);
}

function animateProgress(percent){
  const circle=document.querySelector(".progress-bar");
  const radius=70;
  const circumference=2*Math.PI*radius;
  circle.style.strokeDasharray=circumference;
  circle.style.strokeDashoffset=circumference;
  setTimeout(()=>{
    circle.style.strokeDashoffset=circumference-(percent/100)*circumference;
  },100);
}

function saveQuizResult(quizId, score, outOf) {
  let progress = getProgress();

  if (!progress.quizzesData) progress.quizzesData = [];

  const percent = Math.round((score / outOf) * 100);
  const passed = percent >= 70;

  // Check if quiz already exists
  const existingIndex = progress.quizzesData.findIndex(q => q.id === quizId);
  if (existingIndex !== -1) {
    // Update the existing quiz record
    progress.quizzesData[existingIndex] = {
      id: quizId,
      score: score,
      outOf: outOf,
      percent: percent,
      passed: passed,
      date: new Date().toLocaleDateString()
    };
  } else {
    // Add new quiz record
    progress.quizzesData.push({
      id: quizId,
      score: score,
      outOf: outOf,
      percent: percent,
      passed: passed,
      date: new Date().toLocaleDateString()
    });
  }

  // Update overall quiz count and cumulative totals
  progress.quizzes = progress.quizzesData.length;
  progress.score = progress.quizzesData.reduce((acc, q) => acc + q.score, 0);
  progress.maxScore = progress.quizzesData.reduce((acc, q) => acc + q.outOf, 0);

  localStorage.setItem("mindstocksProgress", JSON.stringify(progress));
}



function showResult() {
  score = answers.reduce((acc, ans, i) =>
    ans === quiz[i].answer ? acc + 1 : acc, 0
  );

  const percent = Math.round((score / quiz.length) * 100);

// ✅ Save results for this quiz
saveQuizResult("quiz2", score, quiz.length);


  // ✅ Result message
  let message = "";
  if (percent >= 70) {
    message = "Great job! You passed this quiz.";
  } else {
    message = "Keep practicing! You need 70% to pass.";
  }

  // --- rest of your result UI code ---
  document.getElementById("quiz-container").style.display = "none";
  document.getElementById("prev-btn").style.display = "none";
  document.getElementById("next-btn").style.display = "none";

  const resultDiv = document.getElementById("result");
  resultDiv.style.display = "block";

  resultDiv.innerHTML = `
    <div class="progress-container">
      <svg width="160" height="160">
        <defs>
          <linearGradient id="scoreGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#ef4444"/>  
            <stop offset="50%" stop-color="#facc15"/> 
            <stop offset="100%" stop-color="#22c55e"/> 
          </linearGradient>
        </defs>
        <circle class="progress-bg" cx="80" cy="80" r="70"></circle>
        <circle class="progress-bar" cx="80" cy="80" r="70" stroke="url(#scoreGradient)"></circle>
      </svg>
      <div class="progress-text">${percent}%</div>
    </div>

    <div class="score-counter"><span id="score-count">0</span> / ${quiz.length}</div>
    <div class="message">${message}</div>

    <div class="review-container">
      <h3>📑 Review Your Answers</h3>
      ${quiz.map((q,i)=>{
        const chosen=answers[i];
        const correct=q.answer;
        const isCorrect = chosen===correct;
        return `
          <div class="review-item ${isCorrect ? "correct" : "wrong"}">
            <h4>Q${i+1}. ${q.question}</h4>
            <p><strong>Your answer:</strong> ${q.options[chosen] || "Not answered"}</p>
            <p><strong>Correct answer:</strong> ${q.options[correct]}</p>
            <p class="explanation">${q.explanation}</p>
          </div>
        `;
      }).join("")}
    </div>

    <div class="quiz-buttons" style="justify-content:center; margin-top:20px;">
      <a href="quizhub.html" class="btn-link">🔄 Back </a>
      <a href="quiz2.html" class="btn-link">➡️ Next Quiz</a>
    </div>
  `;

  animateCounter(document.getElementById("score-count"), score);
  animateProgress(percent);
}
</script>
<script src="toggletheme.js"></script>
</body>
</html>
